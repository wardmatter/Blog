{"title":"Thread TLV Parser","date":"2025-10-14T20:00:38.000Z","date_formatted":{"ll":"Oct 15, 2025","L":"10/15/2025","MM-DD":"10-15"},"updated":"2025-10-14T21:16:40.578Z","content":"\n<style>\n    #tlvInput {\n        font-size: 1rem;\n        min-height: 120px;\n        color: #555;\n        background-color: #fcfcfc;\n        border: 1px solid #ccc;\n        border-radius: 5px;\n        width: 100%;\n        resize: none;\n        box-sizing: border-box;\n    }\n    #parseButton {\n        width: 100%;\n        margin-top: 15px;\n        border: none;\n    }\n    #parseButton::before {\n        content: none;\n    }\n    #resultsTable {\n        word-break: break-all;\n      \tbox-sizing: border-box;\n      \twidth: 100%;\n      \ttext-align: center;\n    }\n    #resultsTable tr {\n        border-bottom: 1px solid var(--inside-accent-color-08);\n        color: black;\n    }\n    #resultsTable thead {\n        background-color: var(--inside-accent-color);\n        color: white;\n    }\n    #results .error {\n        color: #ef5350;\n        font-weight: bold;\n        text-align: center;\n        padding: 15px;\n        border: 1px solid #ef5350;\n        border-radius: 5px;\n        background-color: #ffebee;\n    }\n</style>\n\n\n<div class=\"card\">\n    <div class=\"card-content\">\n        <p>Enter a Thread MeshCoP TLV hex string below to parse it into a human-readable format.</p>\n        <textarea id=\"tlvInput\" class=\"materialize-textarea\" placeholder=\"Paste your TLV hex string here...\"></textarea>\n        <button id=\"parseButton\" class=\"Ï†dp\">\n            Parse TLV\n        </button>\n        <div id=\"results\" style=\"margin-top: 25px;\"></div>\n    </div>\n</div>\n\n<script>\n    (function() {\n        const MESHCOP_TLV_TYPE = {\n            0: \"CHANNEL\", 1: \"PANID\", 2: \"EXTPANID\", 3: \"NETWORKNAME\", 4: \"PSKC\",\n            5: \"NETWORKKEY\", 6: \"NETWORK_KEY_SEQUENCE\", 7: \"MESHLOCALPREFIX\", 8: \"STEERING_DATA\",\n            9: \"BORDER_AGENT_RLOC\", 10: \"COMMISSIONER_ID\", 11: \"COMM_SESSION_ID\", 12: \"SECURITYPOLICY\",\n            13: \"GET\", 14: \"ACTIVETIMESTAMP\", 15: \"COMMISSIONER_UDP_PORT\", 16: \"STATE\",\n            17: \"JOINER_DTLS\", 18: \"JOINER_UDP_PORT\", 19: \"JOINER_IID\", 20: \"JOINER_RLOC\",\n            21: \"JOINER_ROUTER_KEK\", 32: \"PROVISIONING_URL\", 33: \"VENDOR_NAME_TLV\",\n            34: \"VENDOR_MODEL_TLV\", 35: \"VENDOR_SW_VERSION_TLV\", 36: \"VENDOR_DATA_TLV\",\n            37: \"VENDOR_STACK_VERSION_TLV\", 48: \"UDP_ENCAPSULATION_TLV\", 49: \"IPV6_ADDRESS_TLV\",\n            51: \"PENDINGTIMESTAMP\", 52: \"DELAYTIMER\", 53: \"CHANNELMASK\", 54: \"COUNT\",\n            55: \"PERIOD\", 56: \"SCAN_DURATION\", 57: \"ENERGY_LIST\", 59: \"THREAD_DOMAIN_NAME\",\n            74: \"WAKEUP_CHANNEL\", 128: \"DISCOVERYREQUEST\", 129: \"DISCOVERYRESPONSE\", 241: \"JOINERADVERTISEMENT\",\n        };\n\n        const parseButton = document.getElementById('parseButton');\n        const tlvInput = document.getElementById('tlvInput');\n        const resultsDiv = document.getElementById('results');\n\n        const parseTlv = () => {\n            const hexString = tlvInput.value.trim().replace(/\\s+/g, '');\n            resultsDiv.innerHTML = '';\n\n            if (!hexString) return;\n\n            if (hexString.length % 2 !== 0 || !/^[0-9a-fA-F]*$/.test(hexString)) {\n                resultsDiv.innerHTML = '<p class=\"error\">Invalid hex string. Please ensure it has an even number of characters and contains only 0-9 and A-F.</p>';\n                return;\n            }\n\n            try {\n                const data = Array.from(hexString.match(/.{1,2}/g), byte => parseInt(byte, 16));\n                const parsedTlvs = [];\n                let pos = 0;\n\n                while (pos < data.length) {\n                    if (pos + 2 > data.length) throw new Error(\"Incomplete TLV structure.\");\n                    const tag = data[pos++];\n                    const len = data[pos++];\n                    if (pos + len > data.length) throw new Error(\"Invalid length field.\");\n                    \n                    const valueBytes = data.slice(pos, pos + len);\n                    pos += len;\n\n                    const typeName = MESHCOP_TLV_TYPE[tag] || \"UNKNOWN\";\n                    let value;\n\n                    if (tag === 3) { // NETWORKNAME\n                        value = new TextDecoder().decode(Uint8Array.from(valueBytes));\n                    } else {\n                        const hexValue = '0x' + valueBytes.map(b => b.toString(16).padStart(2, '0')).join('');\n                        //Check for CHANNEL tag\n                        if (tag === 0 && valueBytes.length > 0) {\n                            const decValue = parseInt(valueBytes.map(b => b.toString(16).padStart(2, '0')).join(''), 16);\n                            value = `${hexValue} (${decValue})`;\n                        } else {\n                            value = hexValue;\n                        }\n                    }\n\n                    parsedTlvs.push({ tag, typeName, len, value });\n                }\n\n                if (parsedTlvs.length > 0) {\n                    let tableHtml = '<table id=\"resultsTable\" class=\"striped\"><thead><tr><th>Type (dec)</th><th>Type (name)</th><th>Length</th><th>Value</th></tr></thead><tbody>';\n                    parsedTlvs.forEach(tlv => {\n                        tableHtml += `<tr><td>${tlv.tag}</td><td>${tlv.typeName}</td><td>${tlv.len}</td><td>${tlv.value}</td></tr>`;\n                    });\n                    tableHtml += '</tbody></table>';\n                    resultsDiv.innerHTML = tableHtml;\n                } else {\n                     resultsDiv.innerHTML = '<p class=\"error\">No TLVs found in the provided string.</p>';\n                }\n            } catch (error) {\n                resultsDiv.innerHTML = `<p class=\"error\">Error: ${error.message}</p>`;\n            }\n        };\n        \n        if (parseButton) {\n            parseButton.addEventListener('click', parseTlv);\n        }\n    })();\n</script>\n","link":"Thread-TLV-Parser","comments":true,"plink":"http://wardzhou.art/Thread-TLV-Parser/","meta":true}