(function(k,u){typeof exports=="object"&&typeof module<"u"?u(exports):typeof define=="function"&&define.amd?define(["exports"],u):u((k=typeof globalThis<"u"?globalThis:k||self).__inside__||(self.__inside__={}))})(this,(function(k){"use strict";var u=function(){return(u=Object.assign||function(n){for(var e,a=1,r=arguments.length;a<r;a++)for(var o in e=arguments[a])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)},S=/#(?:[0-9a-fA-F]{3}){1,2}/,E=/rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/,p="__inside__",h='-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif',J={accent_color:"#2a2b33",foreground_color:"#363636",border_color:"#e0e0e0",background:"#f3f6f7",sidebar_background:"#2a2b33",card_background:"#fff",content_width:"660px","font.base":h,"font.logo":h,"font.menu":h,"font.heading":h,"font.label":h,"font.code":h,"font.print":h,highlight:["#ffffff","#e0e0e0","#f3f6f7","#95a5b3","#363636","#262b2f","#000000","#000000","#5d6c7b","#40464a","#2980b9","#be516e","#237dac","#944770","#239371","#edf0f3"]},H=typeof document<"u";if(H){document.addEventListener("inside:theme",(function(n){document.dispatchEvent(new CustomEvent("inside",{detail:{type:"theme",data:n.detail}}))})),document.addEventListener("inside",(function(n){if(!H||n.detail.type!=="theme")return!1;L(n.detail.data)}));var P=$(),N=function(){localStorage.removeItem(p),L(u(u({},window[p].theme.default),{name:"default"}),!0)};P&&P.hash===(window[p]||{}).hash?L(P.theme):N()}function $(){var n=localStorage.getItem(p);if(n)try{return JSON.parse(n)}catch{}}function L(n,e){var a,r,o=document.querySelector('style[is="theme"]'),i=document.querySelector('meta[name="theme-color"]'),t=window[p]||{};o||((o=document.createElement("style")).setAttribute("is","theme"),document.body.appendChild(o));var l=(n.name||((r=(a=$())===null||a===void 0?void 0:a.theme)===null||r===void 0?void 0:r.name))==="dark"?"dark":"default";t.theme[l]=Object.assign({},t.theme.default,t.theme[l],n),t.color=[F(t.theme[l].sidebar_background).color||t.theme[l].accent_color].concat(F(t.theme[l].background).color||[]),e&&o.innerHTML||(o.innerHTML=q(t.theme[l]),i&&(i.content=t.color[t.color.length-1])),localStorage.setItem(p,JSON.stringify({theme:t.theme[l],hash:t.hash}))}function q(n){if(!n)return"";var e=(function(o,i){var t={},l=o.accent_color,g=o.foreground_color,x=o.border_color,A=o.background,I=o.sidebar_background,b=o.card_background,m=o.content_width,O=o.highlight,f=(function(c,y){var T={};for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&y.indexOf(d)<0&&(T[d]=c[d]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function"){var j=0;for(d=Object.getOwnPropertySymbols(c);j<d.length;j++)y.indexOf(d[j])<0&&Object.prototype.propertyIsEnumerable.call(c,d[j])&&(T[d[j]]=c[d[j]])}return T})(o,["accent_color","foreground_color","border_color","background","sidebar_background","card_background","content_width","highlight"]);t.accent_color=l?w(l).hex:i.accent_color,t.foreground_color=g?w(g).hex:i.foreground_color,t.border_color=x?w(x).hex:i.border_color,t.background=A?M(A):i.background,t.sidebar_background=I?M(I):t.accent_color||i.sidebar_background,t.card_background=b?M(b):i.card_background;var _=f["font.base"]?s(f["font.base"]):i["font.base"].split(",");t["font.base"]=String(_),t["font.logo"]=f["font.logo"]?s(f["font.logo"],_).join(","):i["font.logo"],t["font.menu"]=f["font.menu"]?s(f["font.menu"],_).join(","):i["font.menu"],t["font.heading"]=f["font.heading"]?s(f["font.heading"],_).join(","):i["font.heading"],t["font.label"]=f["font.label"]?s(f["font.label"],_).join(","):i["font.label"],t["font.code"]=f["font.code"]?s(f["font.code"]).join(","):i["font.code"],t["font.print"]=f["font.print"]?s(f["font.print"]).join(","):i["font.print"];var v=(function(c){if(c){if(typeof c=="number")return{value:c,unit:"px"};var y=c.match(/^(\d+)(%|rem|px)$/);if(y)return{value:+y[1],unit:y[2]}}})(m);return t.content_width=v?v.value+v.unit:i.content_width,Array.isArray(O)?(t.highlight=O.map((function(c){return w(c).hex})).filter((function(c){return c})),t.highlight.length<16&&(t.highlight=i.highlight)):t.highlight=i.highlight,t})(n,J),a=(e.card_background.match(S)||e.card_background.match(E)||[])[0]||e.foreground_color,r=w(e.accent_color);return"html{"+(function(o,i){return o===void 0&&(o={}),i===void 0&&(i="var"),t(o);function t(l,g,x){g===void 0&&(g=[]);var A=function(b){var m=l[b];if(Array.isArray(m))m.forEach((function(f,_){var v,c=_.toString(16);return c.length<2&&(c="0"+c),t(((v={})[c]=f,v),g,b)}));else if(typeof m=="object")t(m,g,b);else{var O=(x?x+"_":"")+b;g.push(["--"+i+"-"+O.replace(/[\._]/g,"-"),m,O])}};for(var I in l)A(I);return g}})(u(u({},e),{card_color:a,accent_color_005:"rgba("+r.r+","+r.g+","+r.b+",.05)",accent_color_01:"rgba("+r.r+","+r.g+","+r.b+",.1)",accent_color_02:"rgba("+r.r+","+r.g+","+r.b+",.2)",accent_color_04:"rgba("+r.r+","+r.g+","+r.b+",.4)",accent_color_08:"rgba("+r.r+","+r.g+","+r.b+",.8)",accent_color:r.hex}),"inside").map((function(o){return o.slice(0,2).join(":")})).join(";")+"}"}function M(n){var e=/(^data:image)|(^[^\(^'^"]*\.(jpg|png|gif|svg))/;return n.split(/\s+/).map((function(a){return a.match(e)?"url("+a+")":a})).join(" ")}function w(n,e){if(n=(n||"").trim(),S.test(n))return u({hex:n},C(n));if(E.test(n)){var a=n.match(E).slice(1,4).map((function(r){return+r})).filter((function(r){return r<256}));if(a.length===3)return{hex:B.apply(null,a),r:a[0],g:a[1],b:a[2]}}return e?u({hex:e},C(e)):{}}function B(n,e,a){return"#"+((1<<24)+(n<<16)+(e<<8)+a).toString(16).slice(1)}function C(n){n=n.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(a,r,o,i){return r+r+o+o+i+i}));var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}function s(n,e){e===void 0&&(e=[]);var a=n?n.split(",").map((function(r){return r.trim()})).filter((function(r){return r})):[];return Array.from(new Set(a.concat(e)))}function F(n){if(!n)return{};var e=n.split(/\s+/);if(S.test(e[0]))return{color:e[0],image:e.slice(1).join(" ")};var a=e.length-1;return e[a]&&S.test(e[a])?{color:e.pop(),image:e.join(" ")}:{image:n}}k.css=q,Object.defineProperty(k,"__esModule",{value:!0})}));
